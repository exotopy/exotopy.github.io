import React, { useState } from 'react';

const TreeOfLife = () => {
  const [selectedNode, setSelectedNode] = useState(null);
  const [selectedPath, setSelectedPath] = useState(null);
  
  // Define the Sephirot positions and data
  const sephirot = {
    kether: { name: 'Kether', x: 200, y: 50 },
    chokhmah: { name: 'Chokhmah', x: 100, y: 150 },
    binah: { name: 'Binah', x: 300, y: 150 },
    chesed: { name: 'Chesed', x: 100, y: 250 },
    geburah: { name: 'Geburah', x: 300, y: 250 },
    tiphareth: { name: 'Tiphareth', x: 200, y: 300 },
    netzach: { name: 'Netzach', x: 100, y: 350 },
    hod: { name: 'Hod', x: 300, y: 350 },
    yesod: { name: 'Yesod', x: 200, y: 400 },
    malkuth: { name: 'Malkuth', x: 200, y: 450 }
  };

  // Define the paths and their associated tarot cards
  const paths = [
    { start: 'kether', end: 'chokhmah', card: '0 Fool' },
    { start: 'kether', end: 'binah', card: '1 Magician' },
    { start: 'chokhmah', end: 'binah', card: '3 Empress' },
    // ... Add all other paths
  ];

  const handleSephirahClick = (name) => {
    setSelectedNode(name);
    setSelectedPath(null);
  };

  const handlePathClick = (path) => {
    setSelectedPath(path);
    setSelectedNode(null);
  };

  const handleBackgroundClick = (e) => {
    if (e.target.tagName === 'DIV') {
      setSelectedNode(null);
      setSelectedPath(null);
    }
  };

  return (
    <div className="h-screen w-full p-4" onClick={handleBackgroundClick}>
      <div className="flex h-full">
        {/* Left panel */}
        <div className="w-1/3 p-4">
          {selectedPath ? (
            <div className="space-y-4">
              <div className="border rounded p-4">
                <input 
                  type="file" 
                  accept="image/*" 
                  className="mb-4"
                />
                <input 
                  type="text" 
                  placeholder="Card Name" 
                  className="w-full mb-2 p-2 border rounded"
                />
                <input 
                  type="text" 
                  placeholder="Hebrew Character" 
                  className="w-full p-2 border rounded"
                />
              </div>
              <div>
                <label className="block mb-2">Correspondences</label>
                <textarea 
                  className="w-full h-64 p-2 border rounded"
                />
              </div>
            </div>
          ) : selectedNode ? (
            <textarea 
              className="w-full h-full p-2 border rounded"
              placeholder="Enter notes for this Sephirah..."
            />
          ) : null}
        </div>

        {/* Center panel with Tree of Life */}
        <div className="w-1/3 relative">
          <svg viewBox="0 0 400 500" className="w-full h-full">
            {/* Draw paths */}
            {paths.map((path, index) => (
              <line
                key={index}
                x1={sephirot[path.start].x}
                y1={sephirot[path.start].y}
                x2={sephirot[path.end].x}
                y2={sephirot[path.end].y}
                stroke="black"
                strokeWidth="2"
                className="cursor-pointer"
                onClick={() => handlePathClick(path)}
              />
            ))}
            
            {/* Draw Sephirot */}
            {Object.entries(sephirot).map(([key, data]) => (
              <g key={key} onClick={() => handleSephirahClick(key)}>
                <circle
                  cx={data.x}
                  cy={data.y}
                  r="20"
                  fill="white"
                  stroke="black"
                  strokeWidth="2"
                  className="cursor-pointer"
                />
                <text
                  x={data.x}
                  y={data.y + 40}
                  textAnchor="middle"
                  className="text-sm"
                >
                  {data.name}
                </text>
              </g>
            ))}
          </svg>
        </div>

        {/* Right panel */}
        <div className="w-1/3 p-4">
          {selectedPath ? (
            <div>
              <label className="block mb-2">Notes</label>
              <textarea 
                className="w-full h-full p-2 border rounded"
                placeholder="Enter notes for this path..."
              />
            </div>
          ) : selectedNode ? (
            <textarea 
              className="w-full h-full p-2 border rounded"
              placeholder="Enter additional notes for this Sephirah..."
            />
          ) : null}
        </div>
      </div>
    </div>
  );
};

export default TreeOfLife;
